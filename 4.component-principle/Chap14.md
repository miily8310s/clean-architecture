# 第１４章 コンポーネントの結合

- 本章で取り上げる３つの原則は、コンポーネントの関連を扱うもの
- コンポーネント構造のアーキテクチャに影響を及ぼすフォースには、技術的なもの、政治的なもの、変動しやすいもの

<!-- @see https://atmarkit.itmedia.co.jp/fdotnet/designptn/designptn07/designptn07_02.html -->

## 非循環依存関係の原則（ADP）

- **非循環依存関係の原則（ADP）**：コンポーネントの依存グラフに循環依存があってはいけない
  - コンポーネント間で循環依存がある場合、コンポーネント単独でのデプロイ、リリースができずその部分が温床となりコンポーネント間での不整合が発生してしまうため
- こうした循環依存が生まれないよう適切に管理する必要がある
- コンポーネント間での依存は、具象クラスレベルではなく、インターフェース等の抽象レイヤーで依存させる
- 循環依存を解消するために、依存関係逆転の原則（DIP）を適用する

## 安定依存の原則（SDP）

- **安定依存の原則（SDP）**：安定度の高い方向に依存すること
- 「安定度」：変更しやすさに比例 →「安定度の高い」= 変更がしづらい
  - 例）多数のコンポーネントから依存されたコンポーネント →（変更することの影響が大きいので）変更しづらい
- 基本的に抽象度の高いレイヤーに依存すべきなので「安定度の高い方向に依存」= 抽象度の高いレイヤーに依存
- 指標の例：
  - 不安定度 = 依存しているコンポーネントの数 / (依存しているコンポーネントの数 + 依存されているコンポーネントの数)
- 依存関係逆転の原則（DIP）を適用すると、安定度が高い新たなコンポーネントを生み出すことができる

## 安定度・抽象度等価の原則（SAP）

- **安定度・抽象度等価の原則（SAP）**：コンポーネントの抽象度は、その安定度と同程度でなければならない
  - 「安定度の高い」コンポーネントは*抽象度も高くある*べきで、安定度の高さが拡張の妨げになってはいけない
  - 逆に「安定度が低い」場合は、その内部の具体的なコードが変更しやすくなるため、安定度の低いコンポーネントは*より具体的である*べき
- 抽象度を表す式：
  - A = コンポーネント内のクラスの総数 ÷ コンポーネント内の抽象クラス・インターフェイス数の総数
